# Tasks (Phase 2)

順序は TDD を優先（契約 → テスト → 実装）。[P] は並列可。

## 契約・データ設計

1. [P] OpenAPI 契約の整備とレビュー（`specs/002-pj-ses/contracts/openapi.yaml`）
2. [P] データモデル最終化（Tag/TagAssignment/Transaction 後方互換）

## テスト（先行）

3. [P] 契約テスト: タグ一覧/作成/更新/無効系
4. [P] 契約テスト: 取引へのタグ付与/置換/重複禁止
5. [P] 統合テスト: レポート生成（ロールアップ、小計/合計）
6. [P] 統合テスト: CSV エクスポート（フルパス列の検証）

## 実装（最小）

7. Tag モデルと CRUD API の追加（任意深さの親子、同親内で name 一意）
8. TagAssignment の導入と取引タグ置換 API
9. 集計サービス: 葉から祖先へロールアップ（重複排除）
10. レポート API と CSV エクスポート
11. Tag 選択 UI: 動的カスケード + 検索 + 複数選択
12. 既存単一タグの後方互換（表示/編集/エクスポート）

## 運用

13. 監査ログ: タグ付与/削除/更新の記録
14. マイグレーション: Prisma schema 更新と移行スクリプト
15. パフォーマンス計測: P95 指標の計測ポイント設置

## 定義の更新

16. ドキュメント更新（quickstart, research, data-model）
